---
date: "2024-07-22T13:52:00+03:00"
description: ""
id: tz2k1zwvxr6691hhiaupchv
publish: true
title: TCP
updated: 1721645732716
---

TCP - Протокол гарантирующий передачу данных и их последовательность на транспортном уровне.
TCP создает надежное полнодуплексное соединение.

## Состав TCP Сегмента (PDU)

- Dst Port
- Src Port
- номер sequence
- номер ack
- отступ фрагмента
- чексумма
- окно
- Опции
- данные

Для каждого сообщения присваивается Sequence number и Acknowledge number благодаря которым можно отслеживать пересылку.

При потере данных данные отслеживаются по sequence и отправляются повторно.

Для управления TCP-соединением используются флаги в отсылаемых TCP-сегментах. Наиболее важными являются:

- `SYN` — используется при установлении TCP-соединения;
- `ACK` — означает, что сегмент был получен принимающей стороной;
- `FIN` — используется при нормальном (graceful) закрытии TCP-соединении;
- `RST` — используется при аварийном закрытии TCP-соединения.

## Пример обмена данными по TCP

1. Client SYN -> Server
2. Client <- SYN, ACK Server
3. Client ACK -> Server
4. Передача данных
5. Client FIN, ACK -> Server
6. Client <- ACK Server
7. Client <- FIN, ACK Server
8. Client ACK -> Server

То есть сначала происходит 3 фазный handshake и открытие коннекта, потом передача, а потом 4 фазный handshake и закрытие коннекта.
